(self.webpackChunkultimate_jekyll=self.webpackChunkultimate_jekyll||[]).push([[641],{641:function(t){var a,n;function i(e){var t=this;e=e||{},t.properties={},t.accountPageInitialized=!1;try{a=e.dom||t.Manager.dom(),n=e.utilities||t.Manager.utilities(),new URL(window.location.href).pathname.includes("account")&&t.initializeAccountPage()}catch(e){console.error("Failed to initialize libraries")}}function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}i.prototype.initializeAccountPage=function(e){var t=this;t.accountPageInitialized||(document.addEventListener("click",(function(e){e.target.matches(".auth-delete-account-btn")&&t.delete().catch((function(e){}))}),!1),t.accountPageInitialized=!0)},i.prototype.delete=function(t){var i=this,r=firebase.auth().currentUser,l=a.select(".auth-delete-account-error-message-element"),p=a.select(".auth-delete-account-confirmation-input").getValue(),s=a.select(".auth-delete-account-btn");return s.setAttribute("disabled",!0).addClass("disabled"),l.setAttribute("hidden",!0),new Promise((function(t,a){function o(e){var t=new Error(e);return l.removeAttribute("hidden").setInnerHTML(t),s.removeAttribute("disabled").removeClass("disabled"),a(t)}return p?r?void r.getIdToken(!1).then((function(e){fetch("https://us-central1-"+n.get(i.Manager,"properties.options.libraries.firebase_app.config.projectId","unknown")+".cloudfunctions.net/bm_api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({authenticationToken:e,command:"delete-user",payload:{}})}).then((function(e){if(!e.ok)return e.text().then((function(t){throw new Error(t||e.statusText||"Unknown error.")}));e.json().then((function(e){return console.log("Successfully deleted account",e),i.Manager.auth().signOut(),t(e)}))})).catch((function(e){return o(e)}))})).catch((function(){return o(e)})):o("Please log in first."):o("Please confirm that you wish to have your account deleted.")}))},i.prototype.resolve=function(e,t){var a=this;return new Promise((function(n,i){var r=firebase.auth().currentUser;return e&&e.auth?r?n(a._resolveAccount(r,e,t)):i(new Error("No currently authenticated user")):r?void firebase.firestore().doc("users/"+r.uid).get().then((function(e){return n(a._resolveAccount(r,e.data(),t))})).catch(i):i(new Error("Malformed <account> input and no currently authenticated user"))}))},i.prototype._resolveAccount=function(e,t,i){var l=this;e=e||{},t=t||{};var p=(i=i||{}).defaultPlanId||"basic";t.auth=t.auth||{},t.auth.email=t.auth.email||e.email||null,t.auth.uid=t.auth.uid||e.uid||null,t.auth.temporary=t.auth.temporary||!1,t.plan=t.plan||{},t.plan.id=t.plan.id||p,t.plan.expires=t.plan.expires||{},t.plan.expires.timestamp=new Date(t.plan.expires.timestamp||0).toISOString(),t.plan.expires.timestampUNIX=Math.round(new Date(t.plan.expires.timestamp||0).getTime()/1e3),t.plan.limits=t.plan.limits||{},t.plan.payment=t.plan.payment||{},t.plan.payment.startDate=t.plan.payment.startDate||{},t.plan.payment.startDate.timestamp=t.plan.payment.startDate.timestamp||"1999-01-01T00:00:00Z",t.plan.payment.startDate.timestampUNIX=t.plan.payment.startDate.timestampUNIX||0,t.plan.payment.frequency=t.plan.payment.frequency||"unknown",t.plan.payment.orderId=t.plan.payment.orderId||"unknown",t.plan.payment.resourceId=t.plan.payment.resourceId||"unknown",t.plan.payment.active=t.plan.payment.active||!1,t.plan.payment.updatedBy=t.plan.payment.updatedBy||{},t.plan.payment.updatedBy.event=t.plan.payment.updatedBy.event||{},t.plan.payment.updatedBy.event.id=t.plan.payment.updatedBy.event.id||"unknown",t.plan.payment.updatedBy.event.name=t.plan.payment.updatedBy.event.name||"unknown",t.plan.payment.updatedBy.date=t.plan.payment.updatedBy.date||{},t.plan.payment.updatedBy.date.timestamp=t.plan.payment.updatedBy.date.timestamp||"1999-01-01T00:00:00Z",t.plan.payment.updatedBy.date.timestampUNIX=t.plan.payment.updatedBy.date.timestampUNIX||0;var s=new Date(t.plan.expires.timestamp),o=new Date,u=Math.floor((s-o)/864e5);let c=(s.getTime()-o.getTime())/864e5;var d,m,y=new Date(t.plan.payment.startDate.timestamp),h=c>-1&&t.plan.id!==p;t.plan.id=h?t.plan.id:p,t.oauth2=t.oauth2||{},t.oauth2.discord=t.oauth2.discord||{},t.oauth2.discord.user=t.oauth2.discord.user||{},t.roles=t.roles||{},t.roles.betaTester=t.plan.id!==p&&(!0===t.roles.betaTester||"true"===t.roles.betaTester),t.roles.developer=!0===t.roles.developer||"true"===t.roles.developer,t.roles.admin=!0===t.roles.admin||"true"===t.roles.admin,t.roles.vip=!0===t.roles.vip||"true"===t.roles.vip,t.roles.promoExempt=!0===t.roles.promoExempt||"true"===t.roles.promoExempt,t.affiliate=t.affiliate||{},t.affiliate.code=t.affiliate.code||"unknown",t.affiliate.referrals=t.affiliate.referrals||[],t.affiliate.referrer=t.affiliate.referrer||"unknown",t.activity=t.activity||{},t.activity.lastActivity=t.activity.lastActivity||{},t.activity.lastActivity.timestamp=t.activity.lastActivity.timestamp||"1999-01-01T00:00:00Z",t.activity.lastActivity.timestampUNIX=t.activity.lastActivity.timestampUNIX||0,t.activity.created=t.activity.created||{},t.activity.created.timestamp=t.activity.created.timestamp||"1999-01-01T00:00:00Z",t.activity.created.timestampUNIX=t.activity.created.timestampUNIX||0,t.api=t.api||{},t.api.clientId=t.api.clientId||"unknown",t.api.privateKey=t.api.privateKey||"unknown";try{var f="development"===n.get(l.Manager,"properties.meta.environment","")?"http://localhost:4001/cancel/":"https://itwcreativeworks.com/portal/account/manage/",v=a.select(".auth-billing-subscribe-btn"),b=a.select(".auth-billing-update-btn"),g=a.select(".auth-billing-plan-id-element"),w=a.select(".auth-billing-frequency-element"),I=a.select(".auth-billing-start-date-element"),k=a.select(".auth-billing-expiration-date-element"),A=new URL(f),T=new URL(window.location.href);v.setAttribute("hidden",!0),b.setAttribute("hidden",!0),h?(A.searchParams.set("appName",n.get(l.Manager,"properties.global.brand.name","Unknown")),A.searchParams.set("supportUrl",T.origin+"/support"),A.searchParams.set("supportEmail",n.get(l.Manager,"properties.contact.emailSupport","unknown@email.com")),A.searchParams.set("userEmail",e.email),A.searchParams.set("userId",e.uid),A.searchParams.set("orderId",t.plan.payment.orderId),A.searchParams.set("resourceId",t.plan.payment.resourceId),b.removeAttribute("hidden").setAttribute("href",A.toString())):v.removeAttribute("hidden"),g.setInnerHTML(r(t.plan.id)),w.setInnerHTML(t.plan.id!==p?" (billed "+r(t.plan.payment.frequency)+")":""),I.setInnerHTML(t.plan.id!==p?" - Purchased "+(["January","February","March","April","May","June","July","August","September","October","November","December"][y.getMonth()]+" ")+y.getDate()+", "+y.getFullYear():""),k.setInnerHTML(t.plan.id!==p&&u<366?'<i class="fas fa-exclamation-triangle mr-1"></i> Expires in '+u+" days ":""),d=".auth-apikey-element",m=n.get(t,"api.privateKey","n/a"),a.select(d).each((function(e,t){"INPUT"===e.tagName?a.select(e).setValue(m):a.select(e).setInnerHTML(m)}))}catch(e){}return l.properties=t,l.properties},t.exports=i}}]);